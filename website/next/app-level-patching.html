<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-app-level-patching" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">App-Level Patching | Copacetic</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://project-copacetic.github.io/copacetic/website/next/app-level-patching"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="App-Level Patching | Copacetic"><meta data-rh="true" name="description" content="App-level patching is an experimental feature that requires setting the COPA_EXPERIMENTAL=1 environment variable to enable. This feature is under active development, and future releases may introduce breaking changes. Feedback is welcome!"><meta data-rh="true" property="og:description" content="App-level patching is an experimental feature that requires setting the COPA_EXPERIMENTAL=1 environment variable to enable. This feature is under active development, and future releases may introduce breaking changes. Feedback is welcome!"><link data-rh="true" rel="icon" href="/copacetic/website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://project-copacetic.github.io/copacetic/website/next/app-level-patching"><link data-rh="true" rel="alternate" href="https://project-copacetic.github.io/copacetic/website/next/app-level-patching" hreflang="en"><link data-rh="true" rel="alternate" href="https://project-copacetic.github.io/copacetic/website/next/app-level-patching" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://V764HJRQUN-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"App-Level Patching","item":"https://project-copacetic.github.io/copacetic/website/next/app-level-patching"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3RC20QPKNS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3RC20QPKNS",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Copacetic" href="/copacetic/website/opensearch.xml"><link rel="stylesheet" href="/copacetic/website/assets/css/styles.8e70b037.css">
<script src="/copacetic/website/assets/js/runtime~main.32ca8505.js" defer="defer"></script>
<script src="/copacetic/website/assets/js/main.212f93a4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/copacetic/website/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://project-copacetic.github.io/copacetic/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/copacetic/website/img/logo.png" alt="Copacetic Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/copacetic/website/img/logo.png" alt="Copacetic Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Copacetic</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/copacetic/website/next/app-level-patching">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/copacetic/website/next/app-level-patching">Next</a></li><li><a class="dropdown__link" href="/copacetic/website/introduction">v0.11.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.10.x">v0.10.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.9.x">v0.9.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.8.x">v0.8.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.7.x">v0.7.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.6.x">v0.6.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.5.x">v0.5.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.4.x">v0.4.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.3.x">v0.3.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.2.x">v0.2.x</a></li><li><a class="dropdown__link" href="/copacetic/website/v0.1.x">v0.1.x</a></li></ul></div><a href="https://cloud-native.slack.com/archives/C071UU5QDKJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-slack-link" aria-label="Slack Connection"></a><a href="https://github.com/project-copacetic/copacetic" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/copacetic/website/next/introduction"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/introduction"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/installation"><span title="Installation" class="linkLabel_WmDU">Installation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/quick-start"><span title="Quick Start" class="linkLabel_WmDU">Quick Start</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/best-practices"><span title="Tagging Guidelines" class="linkLabel_WmDU">Tagging Guidelines</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/faq"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/copacetic/website/next/app-level-patching"><span title="Features" class="categoryLinkLabel_W154">Features</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/copacetic/website/next/app-level-patching"><span title="App-Level Patching" class="linkLabel_WmDU">App-Level Patching</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/github-action"><span title="Github Action" class="linkLabel_WmDU">Github Action</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/docker-extension"><span title="Docker Desktop Extension" class="linkLabel_WmDU">Docker Desktop Extension</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/custom-address"><span title="Custom BuildKit Addresses" class="linkLabel_WmDU">Custom BuildKit Addresses</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/output"><span title="VEX Output" class="linkLabel_WmDU">VEX Output</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/scanner-plugins"><span title="Scanner Plugins" class="linkLabel_WmDU">Scanner Plugins</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/multiplatform-patching"><span title="Multi-Platform Patching" class="linkLabel_WmDU">Multi-Platform Patching</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/copacetic/website/next/contributing"><span title="Contributing" class="categoryLinkLabel_W154">Contributing</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/contributing"><span title="Contributing" class="linkLabel_WmDU">Contributing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/code-of-conduct"><span title="Code of Conduct" class="linkLabel_WmDU">Code of Conduct</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/design"><span title="Design" class="linkLabel_WmDU">Design</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/development-tips"><span title="Development and Testing Tips" class="linkLabel_WmDU">Development and Testing Tips</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/maintainer-guidelines"><span title="Maintainer Guidelines" class="linkLabel_WmDU">Maintainer Guidelines</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/release"><span title="Release Process" class="linkLabel_WmDU">Release Process</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/copacetic/website/next/adopters"><span title="Community" class="categoryLinkLabel_W154">Community</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/adopters"><span title="Adopters" class="linkLabel_WmDU">Adopters</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/copacetic/website/next/talks-and-presentations"><span title="Talks and Presentations" class="linkLabel_WmDU">Talks and Presentations</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Copacetic<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/copacetic/website/introduction">latest version</a></b> (<!-- -->v0.11.x<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/copacetic/website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Features</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">App-Level Patching</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>App-Level Patching</h1></header><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Experimental Feature</div><div class="admonitionContent_BuS1"><p>App-level patching is an experimental feature that requires setting the <code>COPA_EXPERIMENTAL=1</code> environment variable to enable. This feature is under active development, and future releases may introduce breaking changes. Feedback is welcome!</p></div></div>
<p>Copa supports patching application-level dependencies, such as Python packages, in addition to operating system packages. This feature allows you to update vulnerable libraries and packages in various programming language ecosystems.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>App-level patching works by scanning and updating application dependencies found in your container images. Unlike OS-level patching which updates system packages, app-level patching focuses on:</p>
<ul>
<li>Python packages (<code>pip</code> is the supported package manager)</li>
</ul>
<p>Please note that app-level patching requires scanner results that identify vulnerabilities in application libraries.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="package-type-filtering">Package Type Filtering<a href="#package-type-filtering" class="hash-link" aria-label="Direct link to Package Type Filtering" title="Direct link to Package Type Filtering" translate="no">​</a></h2>
<p>Copa supports filtering between different types of packages using the <code>--pkg-types</code> flag:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Patch only OS packages (default)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types os ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Patch only library/app-level packages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types library ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Patch both OS and library packages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types os,library ...</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="package-type-options">Package Type Options<a href="#package-type-options" class="hash-link" aria-label="Direct link to Package Type Options" title="Direct link to Package Type Options" translate="no">​</a></h3>
<ul>
<li><code>os</code>: Operating system packages (APT, YUM, APK, etc.). This is the default behavior if no <code>--pkg-types</code> flag is specified.</li>
<li><code>library</code>: Application-level packages (Python, Node.js, etc.)</li>
<li><code>os,library</code>: Both types</li>
</ul>
<p>This filtering is particularly useful when you want to:</p>
<ul>
<li>Apply different patch policies to OS vs. application dependencies</li>
<li>Separate OS security updates from application updates</li>
<li>Reduce the scope of changes in production environments</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="patch-level-control">Patch Level Control<a href="#patch-level-control" class="hash-link" aria-label="Direct link to Patch Level Control" title="Direct link to Patch Level Control" translate="no">​</a></h2>
<p>Copa allows you to control how aggressively application-level packages are updated based on their versioning. This is particularly useful for managing compatibility and stability in your applications. The <code>--library-patch-level</code> flag determines the maximum version bump allowed for library updates:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Only apply patch-level updates (e.g., 2.6.0 → 2.6.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types library --library-patch-level patch ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Allow minor version updates (e.g., 2.6.0 → 2.7.0, prefer 2.6.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types library --library-patch-level minor ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Allow major version updates (e.g., 2.6.0 → 3.0.0, prefer 2.6.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch -i $IMAGE --pkg-types library --library-patch-level major ...</span><br></span></code></pre></div></div>
<p>Please note that the <code>--library-patch-level</code> flag requires the <code>--pkg-types library</code> option to be set. Default behavior is <code>patch</code> level if not specified.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="patch-level-behavior">Patch Level Behavior<a href="#patch-level-behavior" class="hash-link" aria-label="Direct link to Patch Level Behavior" title="Direct link to Patch Level Behavior" translate="no">​</a></h3>
<p>The patch level determines the maximum version bump allowed for library updates:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="patch-level-recommended"><code>patch</code> Level (Recommended)<a href="#patch-level-recommended" class="hash-link" aria-label="Direct link to patch-level-recommended" title="Direct link to patch-level-recommended" translate="no">​</a></h4>
<ul>
<li><strong>Allows</strong>: <code>2.6.0</code> → <code>2.6.1</code>, <code>2.6.2</code>, etc.</li>
<li><strong>Blocks</strong>: <code>2.6.0</code> → <code>2.7.0</code> or <code>3.0.0</code></li>
<li><strong>Use case</strong>: Conservative updates, minimal risk of breaking changes</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="minor-level"><code>minor</code> Level<a href="#minor-level" class="hash-link" aria-label="Direct link to minor-level" title="Direct link to minor-level" translate="no">​</a></h4>
<ul>
<li><strong>Allows</strong>: <code>2.6.0</code> → <code>2.6.1</code> (preferred) or <code>2.7.0</code></li>
<li><strong>Blocks</strong>: <code>2.6.0</code> → <code>3.0.0</code></li>
<li><strong>Preference</strong>: If both <code>2.6.1</code> and <code>2.7.0</code> are available, it will choose <code>2.6.1</code> (patch) over <code>2.7.0</code> (minor)</li>
<li><strong>Use case</strong>: Moderate updates, some new features acceptable</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="major-level"><code>major</code> Level<a href="#major-level" class="hash-link" aria-label="Direct link to major-level" title="Direct link to major-level" translate="no">​</a></h4>
<ul>
<li><strong>Allows</strong>: Any version update</li>
<li><strong>Preference</strong>: When comma-separated versions are available, prefers Patch &gt; Minor &gt; Major for compatibility. When no comma-separated versions exist, picks the highest version to fix all CVEs.</li>
<li><strong>Example</strong>: If both <code>2.6.1</code> and <code>2.7.0</code> are available, it will choose <code>2.6.1</code> for better compatibility</li>
<li><strong>Use case</strong>: Aggressive updates, all fixes applied regardless of compatibility risk</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Please note that <code>copa</code> does not guarantee compatibility with all versions. The patch level only controls the maximum version bump allowed. Always test your application after patching.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="special-package-handling">Special Package Handling<a href="#special-package-handling" class="hash-link" aria-label="Direct link to Special Package Handling" title="Direct link to Special Package Handling" translate="no">​</a></h3>
<p>Some packages have special handling due to their nature:</p>
<ul>
<li><strong>certifi</strong>: Always updated to the latest version regardless of patch level setting</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples">Usage Examples<a href="#usage-examples" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples" translate="no">​</a></h2>
<p>To use app-level patching, you need to have a scanner result file that contains vulnerabilities for application-level packages. Below is an example of how to scan a Python image and then apply patches using Copa.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">export COPA_EXPERIMENTAL=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export IMAGE=python:3.11.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Scan for Python package vulnerabilities</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">trivy image --vuln-type os,library --ignore-unfixed -f json -o python-scan.json $IMAGE</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-usage">Basic Usage<a href="#basic-usage" class="hash-link" aria-label="Direct link to Basic Usage" title="Direct link to Basic Usage" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Apply patch-level Python package updates only</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -i $IMAGE \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -r python-scan.json \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --pkg-types os,library \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --library-patch-level patch</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ignoring-errors">Ignoring Errors<a href="#ignoring-errors" class="hash-link" aria-label="Direct link to Ignoring Errors" title="Direct link to Ignoring Errors" translate="no">​</a></h3>
<p>Sometimes, certain packages may not be compatible with the patching process or may not have available updates. In such cases, you can use the <code>--ignore-errors</code> flag to allow Copa to continue patching other packages even if some fail. This is useful in environments where you want to apply as many updates as possible without failing the entire patching process.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Apply patch-level Python package updates, ignoring errors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">copa patch \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -i $IMAGE \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -r python-scan.json \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --pkg-types os,library \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --library-patch-level major \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --ignore-errors</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a href="#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations" translate="no">​</a></h2>
<p>Due to nature of app-level patching, it may not be as comprehensive as OS-level patching. Some known limitations are:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="python">Python<a href="#python" class="hash-link" aria-label="Direct link to Python" title="Direct link to Python" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dependency-resolution">Dependency Resolution<a href="#dependency-resolution" class="hash-link" aria-label="Direct link to Dependency Resolution" title="Direct link to Dependency Resolution" translate="no">​</a></h4>
<p>Copa does not perform dependency resolution for application-level packages. It applies updates based on the scanner results without checking for compatibility with other packages in the environment. This means that while Copa can update vulnerable packages, it may not resolve all dependency conflicts that arise from those updates.</p>
<p>For example, if a package has a strict version requirement that conflicts with the updated version, you may encounter errors like:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971 ERROR: Cannot install azure-cli and paramiko==3.4.0 because these package versions have conflicting dependencies.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971 The conflict is caused by:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971     The user requested paramiko==3.4.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971     azure-cli-core 2.40.0 depends on paramiko&lt;3.0.0 and &gt;=2.0.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971 To fix this you could try to:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971 1. loosen the range of package versions you&#x27;ve specified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#8 8.971 2. remove package versions to allow pip attempt to solve the dependency conflict</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="python-version-compatibility">Python Version Compatibility<a href="#python-version-compatibility" class="hash-link" aria-label="Direct link to Python Version Compatibility" title="Direct link to Python Version Compatibility" translate="no">​</a></h4>
<p>Copa does not check whether the updated Python packages are compatible with the Python version in the image. For example, if you update a package that requires Python 3.12 to a version that is not compatible with Python 3.11, you may encounter runtime or dependency resolution errors.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing-and-validation">Testing and Validation<a href="#testing-and-validation" class="hash-link" aria-label="Direct link to Testing and Validation" title="Direct link to Testing and Validation" translate="no">​</a></h4>
<p>Due to the nature of app-level patching, it is <em>highly recommended</em> to thoroughly test your application after applying updates. Copa does not perform any automated testing or validation of the patched application, so you should ensure that your application functions correctly with the updated dependencies.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="non-existent-versions">Non Existent Versions<a href="#non-existent-versions" class="hash-link" aria-label="Direct link to Non Existent Versions" title="Direct link to Non Existent Versions" translate="no">​</a></h4>
<p>Trivy provides vulnerability data for Python dependencies using <a href="https://github.com/advisories" target="_blank" rel="noopener noreferrer">GitHub Security Advisories</a> (GHSA). However, it does not check whether the patched version exists in the <a href="https://pypi.org" target="_blank" rel="noopener noreferrer">Python Package Index</a> (PyPI). For example, <a href="https://github.com/advisories/GHSA-3749-ghw9-m3mg" target="_blank" rel="noopener noreferrer"><code>GHSA-3749-ghw9-m3mg</code></a> contains a vulnerability for torch package, but the patched version <code>2.0.2.7.1-rc1</code> does not exist in PyPI at the time of this writing.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-environment-and-package-manager-support">Virtual Environment and Package Manager Support<a href="#virtual-environment-and-package-manager-support" class="hash-link" aria-label="Direct link to Virtual Environment and Package Manager Support" title="Direct link to Virtual Environment and Package Manager Support" translate="no">​</a></h4>
<p>Currently, only Python packages managed by <code>pip</code> are supported. We have not evaluated or implemented support for virtual environments, or other Python package managers like <code>conda</code> or <code>poetry</code> and others. This might break compatibility with applications that use these package managers.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="replacing-pypi">Replacing PyPI<a href="#replacing-pypi" class="hash-link" aria-label="Direct link to Replacing PyPI" title="Direct link to Replacing PyPI" translate="no">​</a></h4>
<p>Copa does not support replacing the default <a href="https://pypi.org" target="_blank" rel="noopener noreferrer">Python Package Index</a> (PyPI) with a custom index or mirror at this time. This means that all package updates are fetched from the official PyPI repository, which may not be suitable for all environments, especially those with strict network policies or private package registries.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/copacetic/website/next/faq"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">FAQ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/copacetic/website/next/github-action"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Github Action</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#package-type-filtering" class="table-of-contents__link toc-highlight">Package Type Filtering</a><ul><li><a href="#package-type-options" class="table-of-contents__link toc-highlight">Package Type Options</a></li></ul></li><li><a href="#patch-level-control" class="table-of-contents__link toc-highlight">Patch Level Control</a><ul><li><a href="#patch-level-behavior" class="table-of-contents__link toc-highlight">Patch Level Behavior</a></li><li><a href="#special-package-handling" class="table-of-contents__link toc-highlight">Special Package Handling</a></li></ul></li><li><a href="#usage-examples" class="table-of-contents__link toc-highlight">Usage Examples</a><ul><li><a href="#basic-usage" class="table-of-contents__link toc-highlight">Basic Usage</a></li><li><a href="#ignoring-errors" class="table-of-contents__link toc-highlight">Ignoring Errors</a></li></ul></li><li><a href="#limitations" class="table-of-contents__link toc-highlight">Limitations</a><ul><li><a href="#python" class="table-of-contents__link toc-highlight">Python</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Linux Foundation. The Linux Foundation® (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a>.</div></div></div></footer></div>
</body>
</html>