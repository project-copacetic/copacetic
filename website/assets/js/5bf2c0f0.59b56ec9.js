"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7977],{1022:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"custom-address","title":"Custom BuildKit Addresses","description":"Copa automatically detects available BuildKit instances, but you can specify a custom address using the --addr flag for advanced configurations or when automatic detection fails.","source":"@site/versioned_docs/version-v0.11.x/custom-address.md","sourceDirName":".","slug":"/custom-address","permalink":"/copacetic/website/custom-address","draft":false,"unlisted":false,"tags":[],"version":"v0.11.x","frontMatter":{"title":"Custom BuildKit Addresses"},"sidebar":"sidebar","previous":{"title":"Docker Desktop Extension","permalink":"/copacetic/website/docker-extension"},"next":{"title":"Output","permalink":"/copacetic/website/output"}}');var t=d(4848),r=d(8453);const c={title:"Custom BuildKit Addresses"},s=void 0,o={},a=[{value:"Supported Address Formats",id:"supported-address-formats",level:2},{value:"Address Format Reference",id:"address-format-reference",level:2},{value:"Common Use Cases",id:"common-use-cases",level:2},{value:"Default Connection (Recommended)",id:"default-connection-recommended",level:3},{value:"Using a Specific buildx Builder",id:"using-a-specific-buildx-builder",level:3},{value:"BuildKit in a Container",id:"buildkit-in-a-container",level:3},{value:"Docker",id:"docker",level:4},{value:"Podman",id:"podman",level:4}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Copa automatically detects available BuildKit instances, but you can specify a custom address using the ",(0,t.jsx)(n.code,{children:"--addr"})," flag for advanced configurations or when automatic detection fails."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["When using copacetic with the default Docker Desktop driver, you must enable the containerd image store.\nFor instructions, please see the official Docker documentation on using the ",(0,t.jsx)(n.a,{href:"https://docs.docker.com/engine/storage/containerd/",children:"containerd image store"})]})}),"\n",(0,t.jsx)(n.h2,{id:"supported-address-formats",children:"Supported Address Formats"}),"\n",(0,t.jsx)(n.h2,{id:"address-format-reference",children:"Address Format Reference"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Format"}),(0,t.jsx)(n.th,{children:"Example"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"unix://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"unix:///path/to/buildkit.sock"})}),(0,t.jsx)(n.td,{children:"Connect to BuildKit over Unix socket"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"tcp://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"tcp://127.0.0.1:8888"})}),(0,t.jsx)(n.td,{children:"Connect over TCP (not recommended for production)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"docker://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"docker://unix:///var/run/docker.sock"})}),(0,t.jsxs)(n.td,{children:["Connect to Docker daemon (use ",(0,t.jsx)(n.code,{children:"docker://"})," for default)"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"docker-container://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"docker-container://my-buildkit-container"})}),(0,t.jsx)(n.td,{children:"Connect to BuildKit running in Docker container"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"buildx://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"buildx://my-builder"})}),(0,t.jsxs)(n.td,{children:["Connect to buildx builder (use ",(0,t.jsx)(n.code,{children:"buildx://"})," for current)"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nerdctl-container://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"nerdctl-container://my-container-name"})}),(0,t.jsx)(n.td,{children:"Connect via nerdctl to container"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"podman-container://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"podman-container://my-container-name"})}),(0,t.jsx)(n.td,{children:"Connect via Podman to container"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssh://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssh://user@myhost"})}),(0,t.jsx)(n.td,{children:"Connect to remote BuildKit over SSH"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"kubepod://"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"kubepod://mypod?context=foo&namespace=bar"})}),(0,t.jsx)(n.td,{children:"Connect to BuildKit in Kubernetes pod"})]})]})]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"TCP connections without TLS are insecure and should only be used in trusted environments. Always use TLS encryption for production deployments."})}),"\n",(0,t.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,t.jsx)(n.h3,{id:"default-connection-recommended",children:"Default Connection (Recommended)"}),"\n",(0,t.jsx)(n.p,{children:"Copa automatically detects the best available BuildKit instance:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"copa patch -i docker.io/library/nginx:1.21.6 -r nginx.1.21.6.json -t 1.21.6-patched\n"})}),"\n",(0,t.jsx)(n.h3,{id:"using-a-specific-buildx-builder",children:"Using a Specific buildx Builder"}),"\n",(0,t.jsx)(n.p,{children:"Create and use a dedicated buildx builder:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create a new builder\ndocker buildx create --name copa-builder --use\n\n# Use the builder with Copa\ncopa patch -i docker.io/library/nginx:1.21.6 -r nginx.1.21.6.json -t 1.21.6-patched --addr buildx://copa-builder\n"})}),"\n",(0,t.jsx)(n.h3,{id:"buildkit-in-a-container",children:"BuildKit in a Container"}),"\n",(0,t.jsx)(n.p,{children:"Run BuildKit in a dedicated container:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Get the latest BuildKit version from GitHub releases\nexport BUILDKIT_VERSION=$(curl -s https://api.github.com/repos/moby/buildkit/releases/latest | grep \'"tag_name":\' | sed -E \'s/.*"([^"]+)".*/\\1/\')\n'})}),"\n",(0,t.jsx)(n.h4,{id:"docker",children:"Docker"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'docker run \\\n    --detach \\\n    --rm \\\n    --privileged \\\n    --name buildkitd \\\n    --entrypoint buildkitd \\\n    "moby/buildkit:$BUILDKIT_VERSION"\n\n# Use the containerized BuildKit\ncopa patch -i docker.io/library/nginx:1.21.6 -r nginx.1.21.6.json -t 1.21.6-patched --addr docker-container://buildkitd\n'})}),"\n",(0,t.jsx)(n.h4,{id:"podman",children:"Podman"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'podman run \\\n    --detach \\\n    --rm \\\n    --privileged \\\n    --name buildkitd \\\n    --entrypoint buildkitd \\\n    "moby/buildkit:$BUILDKIT_VERSION"\n\n# Connect Copa to Podman-managed BuildKit\ncopa patch -i docker.io/library/nginx:1.21.6 -r nginx.1.21.6.json -t 1.21.6-patched --addr podman-container://buildkitd\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,d)=>{d.d(n,{R:()=>c,x:()=>s});var i=d(6540);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);